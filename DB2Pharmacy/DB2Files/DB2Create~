#!/bin/ksh

db2 connect to db2data > /dev/null

#Create Tables
echo "[DB2] Creating Tables..."

#Product Table
db2 "CREATE TABLE Product(
	SKU varchar(25) NOT NULL,
	Name varchar(70) NOT NULL,
	Department varchar(40),
	IsPrescription integer,
	Price double NOT NULL,
	Stock integer NOT NULL,
	PRIMARY KEY(SKU)
)"

#Sales Table
db2 "CREATE TABLE Sale(
	ID integer NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
	Timestamp timestamp NOT NULL,
	Name varchar(30) NOT NULL,
	PRIMARY KEY(ID)
)"

#Prescription Table
db2 "CREATE TABLE Prescription(
	ID integer NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1),,
	Customer varchar(30) NOT NULL,
	Doctor varchar(30) NOT NULL,
	DateOrdered timestamp NOT NULL,
	DateDelivered timestamp,
	isFulfilled integer NOT NULL,
	PRIMARY KEY(ID)
)"

#SalesProduct Table
db2 "CREATE TABLE SaleProduct(
	ID integer NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1),,
	SaleID integer NOT NULL,
	ProductSKU varchar(70) NOT NULL,
	Quantity integer NOT NULL,
	PRIMARY KEY(ID),
	FOREIGN KEY(SaleID) REFERENCES Sale(ID),
	FOREIGN KEY(ProductSKU) REFERENCES Product(SKU)
)" 

#PrescriptionProduct Table
db2 "CREATE TABLE PrescriptionProduct(
	ID integer NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1),,
	PrescriptionID integer NOT NULL,
	ProductSKU varchar(70) NOT NULL,
	Quantity integer NOT NULL,
	PRIMARY KEY(ID),
	FOREIGN KEY(ProductSKU) REFERENCES Product(SKU),
	FOREIGN KEY(PrescriptionID) REFERENCES Prescription(ID)
)"
echo "[DB2] Creating Tables: Done"
