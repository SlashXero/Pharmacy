#!/bin/ksh
#DB2 Pharmacy - Cashier Script

db2 connect to db2data > /dev/null

SELECTION=-1
# Will print infinitely until the user enters 0 to exit the previous Script.
while [ $SELECTION -ne 0 ]
do
	SELECTION=-1
	#Print Cashier Menu
	echo "----<CASHIER MENU>----"
	echo "1 | Price of a product"
	echo "2 | Record sale"
	echo "3 | Query 3"
	echo "4 | Query 4"
	echo "5 | Query 5"
	echo "0 | RETURN TO MAIN MENU"
	echo "----------------------------"
	echo "Please enter the number corresponding to the selection above: " 
	read SELECTION

	#Select and run user queries
	case $SELECTION in
		1)
			#Price of product
			echo "Enter the Product SKU:"
			read SKU
			echo ">$SKU<"
			db2 "SELECT price FROM product WHERE sku = '$SKU'"
			;;
		2)
			#Record Sale
			echo "Enter the Product SKU:"
			read SKU
			prod_id="$(db2 -x -n "SELECT price FROM product WHERE sku = '$SKU'")" | tr -d ' '
			echo "+$prod_id+"
			db2 "UPDATE product SET stock = stock - 1 WHERE id = $prod_id AND stock > 0"
			db2 "INSERT INTO SaleProduct VALUES (seq_saleprod, )"
			;;
		3)
			#Query 3
			
			;; 
		4)
			#Query 4

			;;
		5)
			#Query 5

			;;
		0)
			#Return to Main Menu
			SELECTION=0
			;;
		*)
			#If user enters soemthing that is NOT part of the selection
			echo "ERROR: Please ONLY enter the selection numbers."
			echo " "
			SELECTION=-1
			;;
	esac
done
